<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Login</title>
		<!-- Sets initial viewport load and disables zooming  -->
		<meta name="viewport" content="initial-scale=1, maximum-scale=1">
		<!-- Include the CSS and JavaScript for ratchet and fontawesome -->
		<script src="js/ratchet.js"></script>
		<link href="css/ratchet.css" rel="stylesheet">
		<link href="css/fontawesome.css" rel="stylesheet">
		<link href="css/general.css" rel="stylesheet">
		<link href="css/signup.css" rel="stylesheet">
		<script src="cordova.js" type="text/javascript"></script>
		<script src="bower_components/argon2-browser/lib/argon2.js"></script>    
		<script src="js/filesystem.js"></script>
		<script type="text/javascript">
			var userinfo;
			document.addEventListener("deviceready", requestFS, false);	
			
			function onLoadFunction(){ // called on load
				setDirectory("UserData");	
			}
			function afterSetDirectory(){
			}			
			function submit(){
				hash(document.getElementById('password').value, document.getElementById('email').value);
			}
			function hash(password, somesalt){
				var hashresult;
				argon2.hash({ pass: password, salt: somesalt })
				.then(h => {
					hashresult = h.hashHex;
					userinfo = '{ "email":"'+ somesalt + '" , "password":"' + password + '"}';
					saveFile("session", hashresult);
					saveFile("userinfo", userinfo);
				})
				.catch(e => console.error(e.message, e.code))
			}
			function saveFileSuccess() {
				//location.replace("home.html");
			}
			function showPW() {
				var x = document.getElementById("password");
				if (x.type === "password") {
					x.type = "text";
				} else {
					x.type = "password";
				}
			}
		</script>
	</head>
	<body>
    <!-- Make sure all your bars are the first things in your <body> -->
		<header class="bar bar-nav">
			<h1 class="title"><b>Healthcare App<b></h1>
		</header>
		<!-- Wrap all non-bar HTML in the .content div (this is actually what scrolls) -->
		<div class="content" id="main">
		<p>
			<form style="margin: 10px 10px 10px 10px ;" action="javascript:submit()">
				<h3><center> Create account <center></h3>
				<input type="email" id="email" placeholder="E-mail" required>
				<input type="password" id="password" placeholder="Password"  required>
				<label class="switch">
					<input type="checkbox" onclick="showPW()">
					<span class="slider"></span>
				</label>
				<label>Show Password</label>
				<br><br>
				<div id="message">
					<h3>Password must contain the following:</h3>
					<p id="letter" class="invalid">A <b>lowercase</b> letter</p>
					<p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
					<p id="number" class="invalid">A <b>number</b></p>
					<p id="special" class="invalid">A <b>Special</b> character</p>
					<p id="length" class="invalid">Minimum <b>8 characters</b></p>
				</div>
				<button class="btn btn-positive btn-block" style="background-color: #10ac84;" id="submitButton" disabled>Submit</button>
			</form>
		</p>
		</div>
	<script src="js/signup.js" type="text/javascript"></script>
	</body>
</html>